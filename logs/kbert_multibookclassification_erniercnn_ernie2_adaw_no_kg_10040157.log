  0%|          | 0/82 [00:00<?, ?it/s]100%|██████████| 82/82 [00:00<00:00, 1181900.10it/s]
model_type:  ['ernie', 'rcnn']
Vocabulary Size:  30522
[BertClassifier] use visible_matrix: False
Some weights of the model checkpoint at ./models/ernie2 were not used when initializing ErnieRCNNForMultiLabelSequenceClassification: ['ernie.pooler.dense.weight', 'ernie.pooler.dense.bias']
- This IS expected if you are initializing ErnieRCNNForMultiLabelSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ErnieRCNNForMultiLabelSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ErnieRCNNForMultiLabelSequenceClassification were not initialized from the model checkpoint at ./models/ernie2 and are newly initialized: ['lstm.bias_hh_l1', 'lstm.bias_ih_l0_reverse', 'lstm.weight_ih_l0_reverse', 'lstm.weight_ih_l0', 'lstm.bias_hh_l1_reverse', 'lstm.bias_ih_l1_reverse', 'lstm.bias_ih_l0', 'lstm.weight_hh_l0_reverse', 'lstm.weight_hh_l1', 'lstm.weight_hh_l1_reverse', 'output_layer_1.bias', 'lstm.weight_ih_l1_reverse', 'lstm.weight_ih_l1', 'lstm.weight_hh_l0', 'lstm.bias_ih_l1', 'classifier.weight', 'lstm.bias_hh_l0', 'lstm.bias_hh_l0_reverse', 'output_layer_1.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
1 GPUs are available. Let's use them.
device:  cuda
Start training.
Loading sentences from ./datasets/book_multilabels_task/train.tsv
There are 9098 sentence in total. We use 1 processes to inject knowledge into sentences.
Progress of process 0: 0/9098
Loading sentences from ./datasets/book_multilabels_task/dev.tsv
There are 2084 sentence in total. We use 1 processes to inject knowledge into sentences.
Progress of process 0: 0/2084
Loading sentences from ./datasets/book_multilabels_task/test.tsv
There are 2067 sentence in total. We use 1 processes to inject knowledge into sentences.
Progress of process 0: 0/2067
Epoch id: 1, Training steps: 100, Avg loss: 0.098, Time: 0:00:47
Epoch id: 1, Training steps: 200, Avg loss: 0.085, Time: 0:01:34
Epoch id: 1, Training steps: 300, Avg loss: 0.091, Time: 0:02:21
Epoch id: 1, Training steps: 400, Avg loss: 0.076, Time: 0:03:09
Epoch id: 1, Training steps: 500, Avg loss: 0.073, Time: 0:03:56
Epoch id: 1, Training steps: 600, Avg loss: 0.066, Time: 0:04:44
Epoch id: 1, Training steps: 700, Avg loss: 0.060, Time: 0:05:31
Start evaluation on dev dataset.
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total):  1.20%% Prec: 0.0245 F1: 0.0202
Start evaluation on test dataset.
torch.Size([3, 512])
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total):  1.02%% Prec: 0.0208 F1: 0.0171
Epoch id: 2, Training steps: 100, Avg loss: 0.065, Time: 0:07:43
Epoch id: 2, Training steps: 200, Avg loss: 0.073, Time: 0:08:30
Epoch id: 2, Training steps: 300, Avg loss: 0.071, Time: 0:09:17
Epoch id: 2, Training steps: 400, Avg loss: 0.040, Time: 0:10:05
Epoch id: 2, Training steps: 500, Avg loss: 0.066, Time: 0:10:52
Epoch id: 2, Training steps: 600, Avg loss: 0.039, Time: 0:11:40
Epoch id: 2, Training steps: 700, Avg loss: 0.049, Time: 0:12:27
Start evaluation on dev dataset.
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total):  3.07%% Prec: 0.0720 F1: 0.0576
Start evaluation on test dataset.
torch.Size([3, 512])
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total):  3.00%% Prec: 0.0735 F1: 0.0587
Epoch id: 3, Training steps: 100, Avg loss: 0.035, Time: 0:14:38
Epoch id: 3, Training steps: 200, Avg loss: 0.055, Time: 0:15:25
Epoch id: 3, Training steps: 300, Avg loss: 0.070, Time: 0:16:13
Epoch id: 3, Training steps: 400, Avg loss: 0.057, Time: 0:17:00
Epoch id: 3, Training steps: 500, Avg loss: 0.047, Time: 0:17:47
Epoch id: 3, Training steps: 600, Avg loss: 0.031, Time: 0:18:35
Epoch id: 3, Training steps: 700, Avg loss: 0.037, Time: 0:19:22
Start evaluation on dev dataset.
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total):  9.45%% Prec: 0.1991 F1: 0.1645
Start evaluation on test dataset.
torch.Size([3, 512])
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total):  9.53%% Prec: 0.2030 F1: 0.1672
Epoch id: 4, Training steps: 100, Avg loss: 0.041, Time: 0:21:33
Epoch id: 4, Training steps: 200, Avg loss: 0.049, Time: 0:22:21
Epoch id: 4, Training steps: 300, Avg loss: 0.055, Time: 0:23:08
Epoch id: 4, Training steps: 400, Avg loss: 0.054, Time: 0:23:55
Epoch id: 4, Training steps: 500, Avg loss: 0.040, Time: 0:24:43
Epoch id: 4, Training steps: 600, Avg loss: 0.041, Time: 0:25:30
Epoch id: 4, Training steps: 700, Avg loss: 0.064, Time: 0:26:17
Start evaluation on dev dataset.
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total):  9.98%% Prec: 0.1883 F1: 0.1591
Start evaluation on test dataset.
torch.Size([3, 512])
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total):  9.00%% Prec: 0.1780 F1: 0.1479
Epoch id: 5, Training steps: 100, Avg loss: 0.038, Time: 0:28:29
Epoch id: 5, Training steps: 200, Avg loss: 0.045, Time: 0:29:16
Epoch id: 5, Training steps: 300, Avg loss: 0.034, Time: 0:30:03
Epoch id: 5, Training steps: 400, Avg loss: 0.044, Time: 0:30:50
Epoch id: 5, Training steps: 500, Avg loss: 0.034, Time: 0:31:38
Epoch id: 5, Training steps: 600, Avg loss: 0.046, Time: 0:32:25
Epoch id: 5, Training steps: 700, Avg loss: 0.048, Time: 0:33:12
Start evaluation on dev dataset.
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 14.20%% Prec: 0.2418 F1: 0.2089
Start evaluation on test dataset.
torch.Size([3, 512])
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 14.42%% Prec: 0.2666 F1: 0.2250
Epoch id: 6, Training steps: 100, Avg loss: 0.030, Time: 0:35:24
Epoch id: 6, Training steps: 200, Avg loss: 0.034, Time: 0:36:11
Epoch id: 6, Training steps: 300, Avg loss: 0.024, Time: 0:36:58
Epoch id: 6, Training steps: 400, Avg loss: 0.041, Time: 0:37:46
Epoch id: 6, Training steps: 500, Avg loss: 0.029, Time: 0:38:33
Epoch id: 6, Training steps: 600, Avg loss: 0.045, Time: 0:39:20
Epoch id: 6, Training steps: 700, Avg loss: 0.015, Time: 0:40:07
Start evaluation on dev dataset.
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 16.36%% Prec: 0.2728 F1: 0.2377
Start evaluation on test dataset.
torch.Size([3, 512])
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 16.11%% Prec: 0.2864 F1: 0.2448
Epoch id: 7, Training steps: 100, Avg loss: 0.031, Time: 0:42:19
Epoch id: 7, Training steps: 200, Avg loss: 0.029, Time: 0:43:06
Epoch id: 7, Training steps: 300, Avg loss: 0.029, Time: 0:43:53
Epoch id: 7, Training steps: 400, Avg loss: 0.026, Time: 0:44:41
Epoch id: 7, Training steps: 500, Avg loss: 0.031, Time: 0:45:28
Epoch id: 7, Training steps: 600, Avg loss: 0.030, Time: 0:46:15
Epoch id: 7, Training steps: 700, Avg loss: 0.025, Time: 0:47:02
Start evaluation on dev dataset.
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 15.93%% Prec: 0.2685 F1: 0.2336
Epoch id: 8, Training steps: 100, Avg loss: 0.036, Time: 0:48:44
Epoch id: 8, Training steps: 200, Avg loss: 0.035, Time: 0:49:32
Epoch id: 8, Training steps: 300, Avg loss: 0.030, Time: 0:50:19
Epoch id: 8, Training steps: 400, Avg loss: 0.013, Time: 0:51:06
Epoch id: 8, Training steps: 500, Avg loss: 0.060, Time: 0:51:54
Epoch id: 8, Training steps: 600, Avg loss: 0.020, Time: 0:52:41
Epoch id: 8, Training steps: 700, Avg loss: 0.019, Time: 0:53:28
Start evaluation on dev dataset.
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 21.02%% Prec: 0.3340 F1: 0.2961
Start evaluation on test dataset.
torch.Size([3, 512])
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 22.11%% Prec: 0.3573 F1: 0.3144
Epoch id: 9, Training steps: 100, Avg loss: 0.024, Time: 0:55:39
Epoch id: 9, Training steps: 200, Avg loss: 0.035, Time: 0:56:26
Epoch id: 9, Training steps: 300, Avg loss: 0.033, Time: 0:57:14
Epoch id: 9, Training steps: 400, Avg loss: 0.027, Time: 0:58:01
Epoch id: 9, Training steps: 500, Avg loss: 0.024, Time: 0:58:48
Epoch id: 9, Training steps: 600, Avg loss: 0.039, Time: 0:59:36
Epoch id: 9, Training steps: 700, Avg loss: 0.046, Time: 1:00:23
Start evaluation on dev dataset.
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 21.79%% Prec: 0.3565 F1: 0.3130
Start evaluation on test dataset.
torch.Size([3, 512])
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 23.03%% Prec: 0.3713 F1: 0.3262
Epoch id: 10, Training steps: 100, Avg loss: 0.014, Time: 1:02:34
Epoch id: 10, Training steps: 200, Avg loss: 0.019, Time: 1:03:21
Epoch id: 10, Training steps: 300, Avg loss: 0.022, Time: 1:04:09
Epoch id: 10, Training steps: 400, Avg loss: 0.029, Time: 1:04:56
Epoch id: 10, Training steps: 500, Avg loss: 0.019, Time: 1:05:43
Epoch id: 10, Training steps: 600, Avg loss: 0.017, Time: 1:06:30
Epoch id: 10, Training steps: 700, Avg loss: 0.021, Time: 1:07:18
Start evaluation on dev dataset.
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 22.12%% Prec: 0.3788 F1: 0.3294
Start evaluation on test dataset.
torch.Size([3, 512])
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 21.92%% Prec: 0.3904 F1: 0.3354
Epoch id: 11, Training steps: 100, Avg loss: 0.024, Time: 1:09:28
Epoch id: 11, Training steps: 200, Avg loss: 0.035, Time: 1:10:15
Epoch id: 11, Training steps: 300, Avg loss: 0.006, Time: 1:11:03
Epoch id: 11, Training steps: 400, Avg loss: 0.034, Time: 1:11:50
Epoch id: 11, Training steps: 500, Avg loss: 0.015, Time: 1:12:37
Epoch id: 11, Training steps: 600, Avg loss: 0.027, Time: 1:13:25
Epoch id: 11, Training steps: 700, Avg loss: 0.023, Time: 1:14:12
Start evaluation on dev dataset.
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 21.11%% Prec: 0.3524 F1: 0.3087
Epoch id: 12, Training steps: 100, Avg loss: 0.016, Time: 1:15:54
Epoch id: 12, Training steps: 200, Avg loss: 0.018, Time: 1:16:41
Epoch id: 12, Training steps: 300, Avg loss: 0.024, Time: 1:17:29
Epoch id: 12, Training steps: 400, Avg loss: 0.019, Time: 1:18:16
Epoch id: 12, Training steps: 500, Avg loss: 0.013, Time: 1:19:03
Epoch id: 12, Training steps: 600, Avg loss: 0.020, Time: 1:19:50
Epoch id: 12, Training steps: 700, Avg loss: 0.013, Time: 1:20:38
Start evaluation on dev dataset.
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 23.90%% Prec: 0.3882 F1: 0.3437
Start evaluation on test dataset.
torch.Size([3, 512])
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 26.27%% Prec: 0.4086 F1: 0.3636
Epoch id: 13, Training steps: 100, Avg loss: 0.014, Time: 1:22:48
Epoch id: 13, Training steps: 200, Avg loss: 0.015, Time: 1:23:35
Epoch id: 13, Training steps: 300, Avg loss: 0.012, Time: 1:24:23
Epoch id: 13, Training steps: 400, Avg loss: 0.013, Time: 1:25:10
Epoch id: 13, Training steps: 500, Avg loss: 0.020, Time: 1:25:57
Epoch id: 13, Training steps: 600, Avg loss: 0.015, Time: 1:26:45
Epoch id: 13, Training steps: 700, Avg loss: 0.013, Time: 1:27:32
Start evaluation on dev dataset.
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 26.78%% Prec: 0.4182 F1: 0.3734
Start evaluation on test dataset.
torch.Size([3, 512])
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 27.72%% Prec: 0.4269 F1: 0.3812
Epoch id: 14, Training steps: 100, Avg loss: 0.022, Time: 1:29:42
Epoch id: 14, Training steps: 200, Avg loss: 0.018, Time: 1:30:30
Epoch id: 14, Training steps: 300, Avg loss: 0.005, Time: 1:31:17
Epoch id: 14, Training steps: 400, Avg loss: 0.004, Time: 1:32:04
Epoch id: 14, Training steps: 500, Avg loss: 0.026, Time: 1:32:51
Epoch id: 14, Training steps: 600, Avg loss: 0.018, Time: 1:33:39
Epoch id: 14, Training steps: 700, Avg loss: 0.026, Time: 1:34:26
Start evaluation on dev dataset.
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 23.42%% Prec: 0.3920 F1: 0.3440
Epoch id: 15, Training steps: 100, Avg loss: 0.009, Time: 1:36:08
Epoch id: 15, Training steps: 200, Avg loss: 0.015, Time: 1:36:55
Epoch id: 15, Training steps: 300, Avg loss: 0.017, Time: 1:37:43
Epoch id: 15, Training steps: 400, Avg loss: 0.025, Time: 1:38:30
Epoch id: 15, Training steps: 500, Avg loss: 0.008, Time: 1:39:17
Epoch id: 15, Training steps: 600, Avg loss: 0.016, Time: 1:40:05
Epoch id: 15, Training steps: 700, Avg loss: 0.015, Time: 1:40:52
Start evaluation on dev dataset.
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 25.72%% Prec: 0.3978 F1: 0.3569
Epoch id: 16, Training steps: 100, Avg loss: 0.028, Time: 1:42:34
Epoch id: 16, Training steps: 200, Avg loss: 0.006, Time: 1:43:21
Epoch id: 16, Training steps: 300, Avg loss: 0.012, Time: 1:44:08
Epoch id: 16, Training steps: 400, Avg loss: 0.011, Time: 1:44:56
Epoch id: 16, Training steps: 500, Avg loss: 0.013, Time: 1:45:43
Epoch id: 16, Training steps: 600, Avg loss: 0.010, Time: 1:46:30
Epoch id: 16, Training steps: 700, Avg loss: 0.009, Time: 1:47:18
Start evaluation on dev dataset.
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 27.16%% Prec: 0.4265 F1: 0.3822
Start evaluation on test dataset.
torch.Size([3, 512])
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 27.77%% Prec: 0.4402 F1: 0.3930
Epoch id: 17, Training steps: 100, Avg loss: 0.008, Time: 1:49:28
Epoch id: 17, Training steps: 200, Avg loss: 0.014, Time: 1:50:15
Epoch id: 17, Training steps: 300, Avg loss: 0.007, Time: 1:51:03
Epoch id: 17, Training steps: 400, Avg loss: 0.018, Time: 1:51:50
Epoch id: 17, Training steps: 500, Avg loss: 0.008, Time: 1:52:37
Epoch id: 17, Training steps: 600, Avg loss: 0.012, Time: 1:53:25
Epoch id: 17, Training steps: 700, Avg loss: 0.007, Time: 1:54:12
Start evaluation on dev dataset.
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 27.93%% Prec: 0.4291 F1: 0.3894
Start evaluation on test dataset.
torch.Size([3, 512])
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 30.43%% Prec: 0.4544 F1: 0.4123
Epoch id: 18, Training steps: 100, Avg loss: 0.014, Time: 1:56:23
Epoch id: 18, Training steps: 200, Avg loss: 0.004, Time: 1:57:10
Epoch id: 18, Training steps: 300, Avg loss: 0.018, Time: 1:57:57
Epoch id: 18, Training steps: 400, Avg loss: 0.005, Time: 1:58:44
Epoch id: 18, Training steps: 500, Avg loss: 0.006, Time: 1:59:32
Epoch id: 18, Training steps: 600, Avg loss: 0.007, Time: 2:00:19
Epoch id: 18, Training steps: 700, Avg loss: 0.015, Time: 2:01:06
Start evaluation on dev dataset.
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 28.69%% Prec: 0.4544 F1: 0.4158
Start evaluation on test dataset.
torch.Size([3, 512])
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 30.43%% Prec: 0.4597 F1: 0.4192
Epoch id: 19, Training steps: 100, Avg loss: 0.007, Time: 2:03:17
Epoch id: 19, Training steps: 200, Avg loss: 0.006, Time: 2:04:04
Epoch id: 19, Training steps: 300, Avg loss: 0.005, Time: 2:04:51
Epoch id: 19, Training steps: 400, Avg loss: 0.007, Time: 2:05:38
Epoch id: 19, Training steps: 500, Avg loss: 0.001, Time: 2:06:26
Epoch id: 19, Training steps: 600, Avg loss: 0.006, Time: 2:07:13
Epoch id: 19, Training steps: 700, Avg loss: 0.011, Time: 2:08:00
Start evaluation on dev dataset.
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 26.82%% Prec: 0.4298 F1: 0.3886
Epoch id: 20, Training steps: 100, Avg loss: 0.003, Time: 2:09:43
Epoch id: 20, Training steps: 200, Avg loss: 0.010, Time: 2:10:30
Epoch id: 20, Training steps: 300, Avg loss: 0.005, Time: 2:11:17
Epoch id: 20, Training steps: 400, Avg loss: 0.003, Time: 2:12:05
Epoch id: 20, Training steps: 500, Avg loss: 0.012, Time: 2:12:52
Epoch id: 20, Training steps: 600, Avg loss: 0.004, Time: 2:13:39
Epoch id: 20, Training steps: 700, Avg loss: 0.007, Time: 2:14:26
Start evaluation on dev dataset.
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 27.30%% Prec: 0.4347 F1: 0.3901
Final evaluation on the test dataset.
The number of evaluation instances:  2067
torch.Size([3, 512])
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Acc. (Correct/Total): 30.43% Prec: 0.4597 F1: 0.4192
Precision, Recall and F1-Score...
              precision    recall  f1-score   support

         教育学     0.8950    0.6722    0.7678       241
          法学     0.7887    0.5000    0.6120       224
      中国语言文学     0.6574    0.3838    0.4846       185
         政治学     0.8108    0.3681    0.5063       163
         社会学     0.7158    0.4331    0.5397       157
         心理学     0.8684    0.2683    0.4099       123
       应用经济学     0.4231    0.2821    0.3385       117
         历史学     0.7468    0.5413    0.6277       109
     环境科学与工程     0.6780    0.3704    0.4790       108
          哲学     0.4429    0.3196    0.3713        97
      外国语言文学     0.6627    0.6471    0.6548        85
         生物学     0.6667    0.3544    0.4628        79
      交通运输工程     0.5902    0.4615    0.5180        78
        临床医学     0.6486    0.3158    0.4248        76
    计算机科学与技术     0.5873    0.5211    0.5522        71
        土木工程     0.5192    0.4091    0.4576        66
   航空宇航科学与技术     0.7679    0.7049    0.7350        61
         民族学     0.5208    0.4545    0.4854        55
   公共卫生与预防医学     0.7297    0.5294    0.6136        51
         美术学     0.5769    0.3000    0.3947        50
         艺术学     0.6667    0.2326    0.3448        43
         地理学     0.7391    0.4048    0.5231        42
         体育学     0.5000    0.1500    0.2308        40
       理论经济学     0.1667    0.0789    0.1071        38
         中医学     0.7143    0.5405    0.6154        37
         物理学     0.5000    0.2778    0.3571        36
          林学     0.7000    0.4242    0.5283        33
          数学     0.1818    0.1250    0.1481        32
     电子科学与技术     0.2308    0.1935    0.2105        31
        基础医学     0.4545    0.1724    0.2500        29
        工商管理     0.0723    0.2222    0.1091        27
       新闻传播学     0.5000    0.4545    0.4762        22
         天文学     0.6316    0.5455    0.5854        22
         地质学     0.5000    0.2381    0.3226        21
         畜牧学     0.7143    0.4762    0.5714        21
   军事思想及军事历史     0.6667    0.4000    0.5000        20
     管理科学与工程     0.4211    0.4444    0.4324        18
     测绘科学与技术     0.6000    0.3529    0.4444        17
        水利工程     0.5455    0.3750    0.4444        16
        大气科学     0.0000    0.0000    0.0000        16
     兵器科学与技术     0.7000    0.4667    0.5600        15
       地球物理学     0.1429    0.0714    0.0952        14
        电气工程     0.2500    0.0769    0.1176        13
         作物学     1.0000    0.1538    0.2667        13
     控制科学与工程     0.1667    0.0769    0.1053        13
     信息与通信工程     1.0000    0.1538    0.2667        13
        公共管理     0.0000    0.0000    0.0000        13
         建筑学     0.6667    0.1538    0.2500        13
     化学工程与技术     0.8000    0.6667    0.7273        12
          力学     1.0000    0.1818    0.3077        11
        海洋科学     0.7000    0.6364    0.6667        11
     轻工技术与工程     0.5714    0.3636    0.4444        11
        农业工程     0.0000    0.0000    0.0000        10
         园艺学     0.0000    0.0000    0.0000        10
       中西医结合     0.7500    0.3000    0.4286        10
        机械工程     0.2000    0.1111    0.1429         9
       科学技术史     0.5000    0.3750    0.4286         8
     船舶与海洋工程     0.6667    0.2500    0.3636         8
   图书情报与档案管理     0.6000    0.3750    0.4615         8
        植物保护     0.5000    0.5000    0.5000         8
     材料科学与工程     0.0000    0.0000    0.0000         8
         统计学     0.0000    0.0000    0.0000         8
          化学     1.0000    0.1250    0.2222         8
     食品科学与工程     1.0000    0.1250    0.2222         8
          水产     0.4000    0.2857    0.3333         7
          药学     1.0000    0.4286    0.6000         7
     农业资源与环境     1.0000    0.4286    0.6000         7
         世界史     0.4286    0.8571    0.5714         7
        系统科学     0.0000    0.0000    0.0000         7
      农林经济管理     0.5000    0.4000    0.4444         5
       军队指挥学     0.0000    0.0000    0.0000         5
        矿业工程     1.0000    0.2000    0.3333         5
     纺织科学与工程     0.0000    0.0000    0.0000         5
  动力工程及工程热物理     0.0000    0.0000    0.0000         4
        林业工程     0.3333    0.2500    0.2857         4
     仪器科学与技术     0.0000    0.0000    0.0000         3
         战略学     1.0000    0.3333    0.5000         3
   地质资源与地质工程     0.0000    0.0000    0.0000         3
        旅游管理     0.0000    0.0000    0.0000         3
 图书馆、情报与档案管理     0.0000    0.0000    0.0000         2
        冶金工程     1.0000    0.5000    0.6667         2
      核科学与技术     0.0000    0.0000    0.0000         2

   micro avg     0.6228    0.3967    0.4847      3093
   macro avg     0.5083    0.2901    0.3482      3093
weighted avg     0.6371    0.3967    0.4766      3093
 samples avg     0.4597    0.4028    0.4192      3093

