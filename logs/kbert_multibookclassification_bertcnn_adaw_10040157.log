Traceback (most recent call last):
  File "/home/lyq2021/experiment/K-BERT-HUGGINGFACE/run_kbert_transformers_cls.py", line 20, in <module>
    from train import train
  File "/home/lyq2021/experiment/K-BERT-HUGGINGFACE/train.py", line 6, in <module>
    from evaluate import evaluate, evaluate_multi_label
  File "/home/lyq2021/experiment/K-BERT-HUGGINGFACE/evaluate.py", line 4, in <module>
    import sklearn.metrics as metrics
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/__init__.py", line 82, in <module>
    from .base import clone
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/base.py", line 17, in <module>
    from .utils import _IS_32BIT
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/utils/__init__.py", line 21, in <module>
    from . import _joblib
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/sklearn/utils/_joblib.py", line 7, in <module>
    import joblib
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/joblib/__init__.py", line 113, in <module>
    from .memory import Memory, MemorizedResult, register_store_backend
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/joblib/memory.py", line 32, in <module>
    from ._store_backends import StoreBackendBase, FileSystemStoreBackend
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/joblib/_store_backends.py", line 15, in <module>
    from .backports import concurrency_safe_rename
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/joblib/backports.py", line 22, in <module>
    import distutils  # noqa
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlibStart training.
Loading sentences from ./datasets/book_multilabels_task/train.tsv
There are 9098 sentence in total. We use 1 processes to inject knowledge into sentences.
Progress of process 0: 0/9098
Loading sentences from ./datasets/book_multilabels_task/dev.tsv
There are 2084 sentence in total. We use 1 processes to inject knowledge into sentences.
Progress of process 0: 0/2084
Loading sentences from ./datasets/book_multilabels_task/test.tsv
There are 2067 sentence in total. We use 1 processes to inject knowledge into sentences.
Progress of process 0: 0/2067
Traceback (most recent call last):
  File "/home/lyq2021/experiment/K-BERT-HUGGINGFACE/run_kbert_transformers_cls.py", line 172, in <module>
    main()
  File "/home/lyq2021/experiment/K-BERT-HUGGINGFACE/run_kbert_transformers_cls.py", line 165, in main
    train(model, train_batch, dev_batch, test_batch, config=config, is_MLC=True)
  File "/home/lyq2021/experiment/K-BERT-HUGGINGFACE/train.py", line 52, in train
    loss, _ = model(input_ids=input_ids_batch, 
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 171, in forward
    outputs = self.parallel_apply(replicas, inputs, kwargs)
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 181, in parallel_apply
    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/torch/nn/parallel/parallel_apply.py", line 89, in parallel_apply
    output.reraise()
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/torch/_utils.py", line 644, in reraise
    raise exception
torch.cuda.OutOfMemoryError: Caught OutOfMemoryError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/torch/nn/parallel/parallel_apply.py", line 64, in _worker
    output = module(*input, **kwargs)
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/lyq2021/experiment/K-BERT-HUGGINGFACE/MultiLabelSequenceClassification.py", line 249, in forward
    outputs = self.bert(input_ids,
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/transformers/models/bert/modeling_bert.py", line 1020, in forward
    encoder_outputs = self.encoder(
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/transformers/models/bert/modeling_bert.py", line 610, in forward
    layer_outputs = layer_module(
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/transformers/models/bert/modeling_bert.py", line 495, in forward
    self_attention_outputs = self.attention(
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/transformers/models/bert/modeling_bert.py", line 425, in forward
    self_outputs = self.self(
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/transformers/models/bert/modeling_bert.py", line 357, in forward
    attention_probs = self.dropout(attention_probs)
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/torch/nn/modules/dropout.py", line 59, in forward
    return F.dropout(input, self.p, self.training, self.inplace)
  File "/home/lyq2021/.conda/envs/lyq2021/lib/python3.10/site-packages/torch/nn/functional.py", line 1252, in dropout
    return _VF.dropout_(input, p, training) if inplace else _VF.dropout(input, p, training)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 96.00 MiB (GPU 0; 10.76 GiB total capacity; 748.33 MiB already allocated; 52.81 MiB free; 796.00 MiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

